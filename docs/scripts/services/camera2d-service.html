<!DOCTYPE html>

<html>
<head>
  <title>camera2d-service.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="..\docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>camera2d-service.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <ul>
<li>camera2d-service.js</li>
<li><p>interactive controls of 2d translation and scale-rotation planes</p>
</li>
<li><p>@dependencies: params services, config, GSAP modules<br>
@param {index.html} Angular object value ‘config’<br>
@param {‘./scripts/services/log-service’} Log<br>
@param {GSAP} TweenMax<br>
@param {GSAP} TimelineMax<br>
@ngInject<br></p>
</li>
<li><p>NOTE: ngInject is used by ngAnnotate to generate a 
minification-safe injection annotation such as:
<code>function($scope) =&gt; [&#39;$scope&#39;, function($scope){}]</code></p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>

angular.module(<span class="hljs-string">'app'</span>).service(<span class="hljs-string">'Camera2d'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(config, Log, 
  TweenMax, TimelineMax)</span></span>{
<span class="hljs-pi">  "use strict"</span>;


  <span class="hljs-keyword">var</span> camera2d,</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>closure vars so ‘this.f’ calls inside Med/Nar are correct<br>
if this.med/nar were instance vars of camera3d ‘this’ would be Camera2d</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      mediator,  
      narrative,</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>same motivation in key handlers (this = window)<br>
this.record_shots would be undefined in key handlers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      record_shots = config.record_shots,
      log = Log.log;


  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Camera2d</span> </span>{  

    constructor(){</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>use narrative scope to get current shot = narrative.scope().shot<brr>
scope is passed in with Camera2d.place</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.scope = <span class="hljs-literal">undefined</span>;
      <span class="hljs-keyword">this</span>.tl = {};
      <span class="hljs-keyword">this</span>.tlp = {};
      <span class="hljs-keyword">this</span>.shot = {};
      <span class="hljs-keyword">this</span>.action = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>dolly - plane</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.plane = <span class="hljs-literal">undefined</span>;
      <span class="hljs-keyword">this</span>.x = <span class="hljs-number">0.0</span>;      <span class="hljs-comment">// plane (webgl y-coord!)</span>
      <span class="hljs-keyword">this</span>.y = <span class="hljs-number">0.0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>zoom and roll - zoom_plane child of plane</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.zoom_plane = <span class="hljs-literal">undefined</span>;
      <span class="hljs-keyword">this</span>.angle = <span class="hljs-number">0.0</span>;  <span class="hljs-comment">// zoom_plane - angle degrees</span>
      <span class="hljs-keyword">this</span>.scale = <span class="hljs-number">1.0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>key controls<br></p>
<ul>
<li>not-alt  =&gt; ‘cut’ - no anim</li>
<li>alt  =&gt; ‘fly’ - anim</li>
<li>not-shft =&gt; rel transform ‘by’</li>
<li>shft =&gt; abs transform ‘to’</li>
<li>NOTE: logging of action is for building e2e_test cell when 
generating e2e_spec</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"keyup"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        <span class="hljs-keyword">var</span> a;
        <span class="hljs-keyword">switch</span>(e.keyCode){</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>CENTER/HOME - normalize camera and csphere<br>
r - home,center - 2d only!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">82</span>: 
            a = {d:<span class="hljs-number">3</span>};
            <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; home</span>
              camera2d.home(a);  
              log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'home'</span>, a:a});
              <span class="hljs-keyword">if</span>(record_shots){
                mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'home'</span>, a:a});
              }
            }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; center - no change to zoom</span>
              camera2d.center(a);
              log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'center'</span>, a:a});
              <span class="hljs-keyword">if</span>(record_shots){
                mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'center'</span>, a:a});
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>ZOOM<br>
z - zoom in          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">90</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {s:<span class="hljs-number">2.0</span>, d:<span class="hljs-number">3</span>};
                camera2d.zoomflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {s:<span class="hljs-number">1.1111</span>, d:<span class="hljs-number">3</span>};
                camera2d.zoomflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {s:<span class="hljs-number">2.0</span>};
                camera2d.zoomcutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {s:<span class="hljs-number">1.1111</span>};
                camera2d.zoomcutBy(a); <span class="hljs-comment">// 1.0/0.9 = 1.1111</span>
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>x - zoom out          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">88</span>:
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {s:<span class="hljs-number">0.5</span>, d:<span class="hljs-number">3</span>};
                camera2d.zoomflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {s:<span class="hljs-number">0.9</span>, d:<span class="hljs-number">3</span>};
                camera2d.zoomflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {s:<span class="hljs-number">0.5</span>};
                camera2d.zoomcutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {s:<span class="hljs-number">0.9</span>};
                camera2d.zoomcutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'zoomcutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>ROLL<br>
c - roll neg =&gt; ccw          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">67</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {r:-<span class="hljs-number">90</span>, d:<span class="hljs-number">3</span>};
                camera2d.rollflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {r:-<span class="hljs-number">22.5</span>, d:<span class="hljs-number">3</span>};
                camera2d.rollflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {r:-<span class="hljs-number">90</span>};
                camera2d.rollcutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {r:-<span class="hljs-number">22.5</span>};
                camera2d.rollcutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>v - roll pos =&gt; cw          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">86</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {r:<span class="hljs-number">90</span>, d:<span class="hljs-number">3</span>};
                camera2d.rollflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {r:<span class="hljs-number">22.5</span>, d:<span class="hljs-number">3</span>};
                camera2d.rollflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {r:<span class="hljs-number">90</span>};
                camera2d.rollcutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {r:<span class="hljs-number">22.5</span>};
                camera2d.rollcutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'rollcutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>DOLLY<br>
q - dollyX+          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">81</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {x:<span class="hljs-number">20</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {x:<span class="hljs-number">10</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {x:<span class="hljs-number">20</span>};
                camera2d.dollycutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {x:<span class="hljs-number">10</span>};
                camera2d.dollycutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>w - dollyX-          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">87</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {x:-<span class="hljs-number">20</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {x:-<span class="hljs-number">10</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {x:-<span class="hljs-number">20</span>};
                camera2d.dollycutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyCutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {x:-<span class="hljs-number">10</span>};
                camera2d.dollycutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyCutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>y - dollyY+          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">89</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {y:<span class="hljs-number">20</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {y:<span class="hljs-number">10</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {y:<span class="hljs-number">20</span>};
                camera2d.dollycutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {y:<span class="hljs-number">10</span>};
                camera2d.dollycutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>u - dollyY-          </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">85</span>: 
            <span class="hljs-keyword">if</span>(e.altKey){     <span class="hljs-comment">// alt =&gt; fly</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// sh =&gt; abs transform ('to')</span>
                a = {y:-<span class="hljs-number">20</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyTo(a);  
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{          <span class="hljs-comment">// no-sh =&gt; rel transform ('by')</span>
                a = {y:-<span class="hljs-number">10</span>, d:<span class="hljs-number">3</span>};
                camera2d.dollyflyBy(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollyflyBy'</span>, a:a});
                }
              }
            }<span class="hljs-keyword">else</span>{            <span class="hljs-comment">// no-alt =&gt; cut</span>
              <span class="hljs-keyword">if</span>(e.shiftKey){ <span class="hljs-comment">// shift  =&gt; 'to'</span>
                a = {y:-<span class="hljs-number">20</span>};
                camera2d.dollycutTo(a);
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutTo'</span>, a:a});
                }
              }<span class="hljs-keyword">else</span>{         
                a = {y:-<span class="hljs-number">10</span>};
                camera2d.dollycutBy(a); 
                log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                <span class="hljs-keyword">if</span>(record_shots){
                  mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'dollycutBy'</span>, a:a});
                }
              }
            }
            <span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>9 - ‘random’ bezier ‘through’ curve  </p>
<ul>
<li>NOTE: bezier() will always fail e2e-spec test because at each run
the vertices and control points are chosen by Math.random() so
one run will never match another.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">case</span> <span class="hljs-number">57</span>:</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>uses default dur=10 npoints=5 </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            camera2d.bezier(); 
            log({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'bezier'</span>, a:{d:<span class="hljs-number">10</span>}});
            <span class="hljs-keyword">if</span>(record_shots){
              mediator.record({t:<span class="hljs-string">'camera2d'</span>, f:<span class="hljs-string">'bezier'</span>, a:{d:<span class="hljs-number">10</span>}});
            }
            <span class="hljs-keyword">break</span>;

          <span class="hljs-keyword">default</span>:
        }
      });
    }<span class="hljs-comment">//ctor</span></pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>tmp!! test action execution<br>
server sends array of three args which expand to test(a,b,c)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    test(a,b,c){
    }

    place(scope) {
      <span class="hljs-keyword">this</span>.scope = scope; <span class="hljs-comment">// Narrative scope</span>
      <span class="hljs-keyword">this</span>.plane = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"plane"</span>);
      <span class="hljs-keyword">this</span>.zoom_plane = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"zoom_plane"</span>);
      <span class="hljs-built_in">console</span>.assert(<span class="hljs-keyword">this</span>.scope, <span class="hljs-string">'error setting scope!'</span>);
      <span class="hljs-built_in">console</span>.assert(<span class="hljs-keyword">this</span>.plane, <span class="hljs-string">'error setting plane!'</span>);
      <span class="hljs-built_in">console</span>.assert(<span class="hljs-keyword">this</span>.zoom_plane, <span class="hljs-string">'error setting zoom_plane!'</span>);
    }

    set_narrative(o){
      narrative = o;
    }

    set_mediator(o){
      mediator = o;
    }

    actor(id){
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.getElementById(id);
    }


    center(a) {  
      a.d = a.d || <span class="hljs-number">0.0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>},
                 actors:{
                   <span class="hljs-string">'i2d:plane'</span>:[{dur:a.d, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">'y'</span>: <span class="hljs-number">0.0</span>, immediateRender:<span class="hljs-literal">false</span>}}],
                   <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:a.d, p:{<span class="hljs-string">'rotation'</span>: <span class="hljs-number">0.0</span>,
                      svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                 }
                }<span class="hljs-comment">//tl</span>
                }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }


    home(a) {  
      a.d = a.d || <span class="hljs-number">0.0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>},
                 actors:{
                   <span class="hljs-string">'i2d:plane'</span>:[{dur:a.d, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">'y'</span>: <span class="hljs-number">0.0</span>, immediateRender:<span class="hljs-literal">false</span>}}],
                   <span class="hljs-string">'i2d:zoom_plane'</span>: [{dur:a.d, p:{rotation: <span class="hljs-number">0.0</span>,
                   scale:<span class="hljs-number">1.0</span>, svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                 }
                }<span class="hljs-comment">//tl</span>
                }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>ZOOM<br>
cut - no animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    zoomcutTo(a) {  
      <span class="hljs-keyword">if</span>(a.s !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.scale = a.s;}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
                    timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                               actors:{
                                <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:<span class="hljs-number">0</span>, p:{<span class="hljs-string">'scale'</span>:<span class="hljs-keyword">this</span>.scale,
                                  svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                               }
                              }<span class="hljs-comment">//tl</span>
                          }<span class="hljs-comment">//delta</span>
                  };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    zoomcutBy(a) {   
      <span class="hljs-keyword">if</span>(a.s !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.scale *= a.s;}</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
                    timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                               actors:{
                                <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:<span class="hljs-number">0</span>, p:{<span class="hljs-string">'scale'</span>:<span class="hljs-keyword">this</span>.scale,
                                  svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                               }
                              }<span class="hljs-comment">//tl</span>
                          }<span class="hljs-comment">//delta</span>
                  };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>fly - animate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    zoomflyTo(a) {   
      <span class="hljs-keyword">if</span>(a.s !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.scale = a.s;}</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
                    timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                               actors:{
                                <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:a.d, p:{<span class="hljs-string">'scale'</span>:<span class="hljs-keyword">this</span>.scale,
                                  svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                               }
                              }<span class="hljs-comment">//tl</span>
                          }<span class="hljs-comment">//delta</span>
                  };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    zoomflyBy(a) {   
      <span class="hljs-keyword">if</span>(a.s !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.scale *= a.s;}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
                    timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                               actors:{
                                <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:a.d, p:{<span class="hljs-string">'scale'</span>:<span class="hljs-keyword">this</span>.scale,
                                  svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                               }
                              }<span class="hljs-comment">//tl</span>
                          }<span class="hljs-comment">//delta</span>
                  };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>ROLL<br>
cut - no animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    rollcutTo(a) {  
      <span class="hljs-keyword">if</span>(a.r !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.angle = a.r;}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:<span class="hljs-number">0</span>, p:{<span class="hljs-string">'rotation'</span>:<span class="hljs-keyword">this</span>.angle,
                        svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    rollcutBy(a) {  
      <span class="hljs-keyword">if</span>(a.r !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.angle += a.r;}</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:<span class="hljs-number">0</span>, p:{<span class="hljs-string">'rotation'</span>:<span class="hljs-keyword">this</span>.angle,
                        svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>fly - animate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    rollflyTo(a) {  
      <span class="hljs-keyword">if</span>(a.r !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.angle = a.r;}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:a.d, p:{<span class="hljs-string">'rotation'</span>:<span class="hljs-keyword">this</span>.angle,
                        svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    rollflyBy(a) {  
      <span class="hljs-keyword">if</span>(a.r !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.angle += a.r;}</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>shot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:zoom_plane'</span>:[{dur:a.d, p:{<span class="hljs-string">'rotation'</span>:<span class="hljs-keyword">this</span>.angle,
                        svgOrigin:<span class="hljs-string">'0% 0%'</span>, immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>DOLLY<br>
cut - no animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    dollycutTo(a) { 
      <span class="hljs-keyword">if</span>(a.x !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.x = a.x;}
      <span class="hljs-keyword">if</span>(a.y !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.y = a.y;}</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>shot<br>
y-coords are webgl - svg translateY must be negated!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:plane'</span>:[{dur:<span class="hljs-number">0</span>, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-keyword">this</span>.x, <span class="hljs-string">'y'</span>: -<span class="hljs-keyword">this</span>.y,
                                     immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    dollycutBy(a) { 
      <span class="hljs-keyword">if</span>(a.x !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.x += a.x;}
      <span class="hljs-keyword">if</span>(a.y !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.y += a.y;}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>shot<br>
y-coords are webgl - svg translateY must be negated!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:plane'</span>:[{dur:<span class="hljs-number">0</span>, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-keyword">this</span>.x, <span class="hljs-string">'y'</span>: -<span class="hljs-keyword">this</span>.y,
                                     immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>fly - animate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    dollyflyTo(a) { 
      <span class="hljs-keyword">if</span>(a.x !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.x = a.x;}
      <span class="hljs-keyword">if</span>(a.y !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.y = a.y;}</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>shot<br>
y-coords are webgl - svg translateY must be negated!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:plane'</span>:[{dur:a.d, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-keyword">this</span>.x, <span class="hljs-string">'y'</span>: -<span class="hljs-keyword">this</span>.y,
                                     immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
    dollyflyBy(a) { 
      <span class="hljs-keyword">if</span>(a.x !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.x += a.x;}
      <span class="hljs-keyword">if</span>(a.y !== <span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.y += a.y;}</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>shot<br>
y-coords are webgl - svg translateY must be negated!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:plane'</span>:[{dur:a.d, 
                                   p:{<span class="hljs-string">'x'</span>: <span class="hljs-keyword">this</span>.x, <span class="hljs-string">'y'</span>: -<span class="hljs-keyword">this</span>.y,
                                     immediateRender:<span class="hljs-literal">false</span>}}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>random 2d-bezier camera nav<br> 
use default 6 points and ‘through’ bezier curve type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    bezier(a={d:<span class="hljs-number">10</span>, n:<span class="hljs-number">6</span>}){
      <span class="hljs-keyword">var</span> i,
          x = [],
          y = [],
          v = [],
          bezier;</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>bezier ‘through’ curve points - y coords are made neg!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      x[<span class="hljs-number">0</span>] = <span class="hljs-number">0.0</span>;
      y[<span class="hljs-number">0</span>] = <span class="hljs-number">0.0</span>;
      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span>){
        x[<span class="hljs-number">1</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();   <span class="hljs-comment">// ++</span>
        y[<span class="hljs-number">1</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">2</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// -+</span>
        y[<span class="hljs-number">2</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">3</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// --</span>
        y[<span class="hljs-number">3</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">4</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// +-</span>
        y[<span class="hljs-number">4</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
      }<span class="hljs-keyword">else</span>{
        x[<span class="hljs-number">1</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();   <span class="hljs-comment">// --</span>
        y[<span class="hljs-number">1</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">2</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// -+</span>
        y[<span class="hljs-number">2</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">3</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// ++</span>
        y[<span class="hljs-number">3</span>] = -<span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
        x[<span class="hljs-number">4</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();  <span class="hljs-comment">// +-</span>
        y[<span class="hljs-number">4</span>] = <span class="hljs-number">30.0</span>*<span class="hljs-built_in">Math</span>.random();
      }
      x[<span class="hljs-number">5</span>] = <span class="hljs-number">0.0</span>;
      y[<span class="hljs-number">5</span>] = <span class="hljs-number">0.0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>create values array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>; i&lt;a.n; i++){
        v.push({x:x[i], y:y[i]});
      }
      bezier = {bezier:{autoRotate:<span class="hljs-literal">true</span>, 
                        curviness:<span class="hljs-number">2</span>, 
                        values:v,
                        immediateRender:<span class="hljs-literal">false</span>}};</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>shot<br>
y-coords are webgl - svg translateY must be negated!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.shot = {delta: {
        timeline: {p: {paused:<span class="hljs-literal">true</span>, repeat:<span class="hljs-number">0</span>, tweens:[]},
                   actors:{
                     <span class="hljs-string">'i2d:c'</span>:[{dur:a.d, p:bezier}]
                   }
                  }<span class="hljs-comment">//tl</span>
                  }<span class="hljs-comment">//delta</span>
      };<span class="hljs-comment">//shot</span>
      <span class="hljs-keyword">this</span>.shot = <span class="hljs-string">'shot-anim:'</span> + <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.shot);
      narrative.shot(<span class="hljs-keyword">this</span>.shot);
    }
  }<span class="hljs-comment">//Camera2D</span></pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>return factory object<btr>
(redundant) maintenance of Singleton</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span>(!camera2d){
    camera2d = <span class="hljs-keyword">new</span> Camera2d();  <span class="hljs-comment">// create Camera2d singleton instance</span>
  }
  <span class="hljs-keyword">return</span> camera2d;           <span class="hljs-comment">// return Camera2d singleton instance</span>
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
